<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>模擬 KKTIX 搶票</title>
    <link rel="stylesheet" href="styles.css">
    <script defer src="script.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap');
        body {
            font-family: 'Roboto', Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
        }

        header {
            background-color: #64c025;
            padding: 10px 0;
            color: white;
            text-align: center;
            font-size: 24px;
        }

        header nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            justify-content: center;
        }

        header nav ul li {
            margin: 0 15px;
        }

        header nav ul li a {
            color: white;
            text-decoration: none;
            font-size: 18px;
        }

        header nav ul li a:hover {
            text-decoration: underline;
        }

        .container {
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            border: none;
            border-radius: 10px;
            text-align: center;
            position: relative;
        }

        .container img {
            max-width: 100%;
            height: auto;
            border-radius: 5px;
        }

        .container::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 0;
            width: 100%;
            height: 2px;
            background-color: #ddd;
            margin-top: 20px;
        }

        .content {
            padding-top: 20px;
            background-color: #f0f0f0;
        }

        .progress-bar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .step {
            flex: 1;
            text-align: center;
            padding: 10px;
            border-radius: 20px;
            background: #ddd;
            color: #555;
        }

        .step.active {
            background: #64c025;
            color: white;
        }

        .ticket-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        .ticket-table th, .ticket-table td {
            border-bottom: 1px solid #ddd;
            padding: 10px;
            text-align: center;
        }

        .ticket-table button {
            padding: 5px 10px;
            border: none;
            background: #64c025;
            color: white;
            font-size: 16px;
            cursor: pointer;
            border-radius: 5px;
        }

        .ticket-table button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .terms {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .terms input {
            margin-right: 10px;
        }

        .terms a {
            color: #64c025;
            text-decoration: none;
        }

        #next-button {
            width: 100%;
            padding: 10px;
            border: none;
            background: #64c025;
            color: white;
            font-size: 18px;
            cursor: pointer;
            border-radius: 5px;
        }

        #next-button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .countdown {
            font-size: 24px;
            font-weight: bold;
            color: #ff6347;
            margin-top: 20px;
        }

        #start-button {
            width: 17%;
            padding: 7px;
            border: none;
            background: #f0be08;
            color: #ffffff;
            font-size: 18px;
            cursor: pointer;
            border-radius: 5px;
        }

        .hidden {
            display: none;
        }

        #result-message {
            background-color: #64c025;
            color: white;
            padding: 20px;
            margin-top: 20px;
            border-radius: 8px;
            text-align: center;
            font-size: 18px;
        }

        #countdown-display {
            color: #ff6347;
            font-size: 22px;
        }

        /* 用戶資料表單 */
        .user-form {
            margin-top: 20px;
            text-align: left;
        }

        .user-form input {
            padding: 8px;
            width: 100%;
            margin-bottom: 10px;
            border-radius: 5px;
            border: 1px solid #ddd;
        }

        .user-form label {
            font-size: 16px;
            display: block;
            margin-bottom: 5px;
        }

    </style>
</head>
<body>
    <header style="display: flex; justify-content: space-between; align-items: center; padding: 10px;">
        <nav>
            <ul style="display: flex; padding: 0; margin: 0; margin-left: 80px;">
                <li><img src="imgs/KKTIX.png" /></li>
            </ul>
        </nav>
        <div style="margin-right: 80px;">
            <a style="font-size: 20px;">user▼</a>
        </div>
    </header>

    <div class="container">
        <div><img src="imgs/水啦.png" alt="水啦" /></div>

        <label for="countdown-input">請輸入倒數秒數：</label>
        <input type="number" id="countdown-input" min="1" placeholder="秒數" />
        <button id="start-button">開始倒數</button>

        <div class="countdown hidden" id="countdown-display">倒數計時：<span id="countdown-time"></span></div>
        <br><br>

        <div class="progress-bar">
            <div class="step active" id="step-1">1 選擇票種</div>
            <div class="step" id="step-2">2 填寫表單</div>
            <div class="step" id="step-3">3 取票繳費</div>
        </div>

        <table class="ticket-table" id="ticket-table">
            <thead>
                <tr>
                    <th>票種</th>
                    <th>票價</th>
                    <th>數量</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>單人票</td>
                    <td>TWD$600</td>
                    <td>
                        <button class="minus" data-type="single" disabled>-</button>
                        <span id="single-count">0</span>
                        <button class="plus" data-type="single">+</button>
                    </td>
                </tr>
                <tr>
                    <td>雙人套票</td>
                    <td>TWD$500</td>
                    <td>
                        <button class="minus" data-type="double" disabled>-</button>
                        <span id="double-count">0</span>
                        <button class="plus" data-type="double">+</button>
                    </td>
                </tr>
            </tbody>
        </table>

        <label class="terms">
            <input type="checkbox" id="terms-checkbox"> 我已閱讀並同意 <a href="https://kktix.com/terms">服務條款</a> 與 <a href="https://kktix.com/policy">隱私權政策</a>
        </label>

        <button id="next-button" disabled>下一步</button>

        <div class="user-form hidden" id="user-form">
            <label for="name">姓名：</label>
            <input type="text" id="name" placeholder="請輸入您的姓名" />
            <label for="phone">電話：</label>
            <input type="text" id="phone" placeholder="請輸入您的電話" />
            <button id="confirm-button">確認資料</button>
        </div>

        <div id="result-message" class="hidden">
            <p id="message-text"></p>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const startButton = document.getElementById("start-button");
            const countdownInput = document.getElementById("countdown-input");
            const countdownDisplay = document.getElementById("countdown-display");
            const countdownTime = document.getElementById("countdown-time");
            const ticketTable = document.getElementById("ticket-table");
            const nextButton = document.getElementById("next-button");
            const termsCheckbox = document.getElementById("terms-checkbox");
            const singleCount = document.getElementById("single-count");
            const doubleCount = document.getElementById("double-count");
            const step1 = document.getElementById("step-1");
            const step2 = document.getElementById("step-2");
            const step3 = document.getElementById("step-3");
            const userForm = document.getElementById("user-form");
            const confirmButton = document.getElementById("confirm-button");
            let countdownInterval;
            let countdown;
            let countdownStartTime;
            let processStartTime;

            function updateButtonState() {
                nextButton.disabled = !(parseInt(singleCount.textContent) > 0 || parseInt(doubleCount.textContent) > 0) || !termsCheckbox.checked;
            }

            startButton.addEventListener("click", () => {
                countdown = parseInt(countdownInput.value);
                if (isNaN(countdown) || countdown <= 0) {
                    alert("請輸入有效的倒數秒數");
                    return;
                }

                startButton.classList.add("hidden");
                countdownDisplay.classList.remove("hidden");
                countdownTime.textContent = countdown;

                countdownStartTime = Date.now();
                countdownInterval = setInterval(() => {
                    let remainingTime = countdown - Math.floor((Date.now() - countdownStartTime) / 1000);
                    if (remainingTime <= 0) {
                        clearInterval(countdownInterval);
                        countdownDisplay.textContent = "倒數結束！";
                        nextButton.disabled = false;
                        step1.classList.remove("active");
                        step2.classList.add("active");
                    } else {
                        countdownTime.textContent = remainingTime;
                    }
                }, 1000);
            });

            // 修改票數加減功能
            ticketTable.addEventListener("click", (event) => {
                const target = event.target;
                if (target.tagName === "BUTTON") {
                    const type = target.getAttribute("data-type");
                    if (type === "single") {
                        if (target.classList.contains("plus")) {
                            singleCount.textContent = parseInt(singleCount.textContent) + 1;
                        } else {
                            if (parseInt(singleCount.textContent) > 0) {
                                singleCount.textContent = parseInt(singleCount.textContent) - 1;
                            }
                        }
                    } else if (type === "double") {
                        if (target.classList.contains("plus")) {
                            doubleCount.textContent = parseInt(doubleCount.textContent) + 1;
                        } else {
                            if (parseInt(doubleCount.textContent) > 0) {
                                doubleCount.textContent = parseInt(doubleCount.textContent) - 1;
                            }
                        }
                    }

                    // 更新按鈕狀態
                    updateButtonState();
                }
            });

            termsCheckbox.addEventListener("change", updateButtonState);

            nextButton.addEventListener("click", () => {
                // 顯示用戶表單
                step2.classList.remove("active");
                step3.classList.add("active");
                userForm.classList.remove("hidden");
            });

            confirmButton.addEventListener("click", () => {
                const name = document.getElementById("name").value;
                const phone = document.getElementById("phone").value;

                if (!name || !phone) {
                    alert("請填寫完整資料！");
                    return;
                }

                document.getElementById("result-message").classList.remove("hidden");
                document.getElementById("message-text").textContent = `搶票成功！您的資料：姓名 - ${name}，電話 - ${phone}`;
            });
        });
    </script>
</body>
</html>
